@model Movie

@functions {
    public string TruncateWords(string text, int wordLimit)
    {
        if (string.IsNullOrWhiteSpace(text)) return "";
        var words = text.Split(' ');
        if (words.Length <= wordLimit) return text;
        return string.Join(" ", words.Take(wordLimit)) + "...";
    }
}

<div class="col">
    <div class="card h-100 shadow-sm">
        <img src="@(string.IsNullOrWhiteSpace(Model.PosterUrl) ? "https://via.placeholder.com/500x750?text=No+Poster" : Model.PosterUrl)"
             class="card-img-top"
             alt="@Model.Title poster"
             style="max-height: 375px; object-fit: cover;"
             onerror="this.onerror=null;this.src='https://via.placeholder.com/500x750?text=No+Poster';" />
        <div class="card-body d-flex flex-column">
            <div class="mb-2">
                <h5 class="card-title mb-1">@Model.Title</h5>
                <p class="card-subtitle text-muted">@Model.Year &middot; @Model.Genre</p>
            </div>
            <p class="card-text text-muted flex-grow-1">
                @TruncateWords(Model.Description, 20)
            </p>
            <a asp-controller="Movies"
               asp-action="Details_user"
               asp-route-id="@Model.Id"
               class="btn btn-primary mt-auto">
                View details
            </a>
        </div>
    </div>
</div>